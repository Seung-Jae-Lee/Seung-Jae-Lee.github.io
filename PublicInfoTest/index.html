<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Busan Radiation Place List</title>
<script type="text/javascript">

</script>
</head>
<body>
<div>DOM 테스트</div>
<div>
    <input type="button" value="XML DOM" onclick="GetData()">
</div>
result : <div id="result"></div>
</body>
</html>
<script type="text/javascript">
var xmlDoc;

function GetData
{
  var doc = GetXMLDom('RadiationPlaceList.xml');
  var domcnt = GetDomLength("items");
  var txt = "";
  for(var i=0; i<cnt; i++)
  {
    txt = txt + GetValue("name",i);
  }
  document.getElementById("result").innerHTML=txt;
}
function GetXmlOBJ
{
  var xmlhttp = null;

  // Mozilla/Safari
  if (window.XMLHttpRequest) {
    xmlhttp = new XMLHttpRequest();
  }
  else if (window.ActiveXObject) {// IE
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
  }
  return xmlhttp;
}

function GetXMLDom(pUrl,pOption,pSearchValue)
{
  var xmlhttp = GetXmlOBJ();
  var templateStr = null;
  var pAsync = false;

  if (pOption == "TRUE")
  {
    pAsync = true;
  }

  if (pOption == "POST")
  {
    xmlhttp.open("POST",pUrl,pAsync);
    xmlhttp.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
  }
  else
  {
    xmlhttp.open("GET",pUrl,pAsync);
  }

  xmlhttp.onreadystatechange = function () {
    if(xmlhttp.readyState == "4")
    {
      xmlDoc = xmlhttp.responseXML;
    }
  }

  xmlhttp.send();
  return xmlDoc;
}

function GetDomLength(pName,pDom)
{
  try
  {
    return pDom.getElementsByTagName(pName).length;
  }
  catch (e)
  {
    return xmlDoc.getElementsByTagName(pName).length;
  }
}

function GetValue(pName,pIndex,pAttr)
{
  if (typeof pIndex == "undefined" || pIndex =="")
  {
    pIndex = 0;
  }

  x = xmlDoc.getElementsByTagName(pName);

  if (typeof pAttr == "undefined" || pAttr =="")
  {
    if(x[pIndex].hasChildNodes())
    {
      v = x[pIndex].childNodes[0].nodeValue;
    }
    else
    {
      v = "";
    }
  }
  else
  {
    v = x[pIndex].getAttribute(pAttr);
  }
  return v;
}

function GetXMLText(pCode,pValue)
{
  var xDom = GetXMLDom('code_test.xml');
  var cnt = GetDomLength(pCode,xDom);
  var strHTML = ""  ;
  for(var i=0;i<cnt;i++)
  {
    if(GetValue(pCode,i,"code") == pValue)
    strHTML = GetValue(pCode,i,"text");
  }
  return strHTML;
}

</script>
