<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Busan Radiation Place List</title>
<script type="text/javascript">

</script>
</head>
<body>
<div>DOM 테스트</div>
<div>
    <input type="button" id = "test" value="XML DOM" onclick="getData()">
</div>
result : <div id="result"></div>
</body>
</html>

<script type="text/javascript">

var xmlDoc;
var link = 'http://opendata.busan.go.kr/openapi/service/EnvironmentalRadiationInfoService/getEnvironmentalRadiationPlaceList?ServiceKey=';
var key = '4KBLkLFia5DFZivxgcFUJesrUcnYOXnaS4jSqWAcnnhy8qGljIsNnl3wE2BjpbdFwSU70dbproeBjstLquF7sg%3D%3D';
var msg = link + key;

function getData()
{
  //var doc = getXMLDom('RadiationPlaceList.xml');
  var doc = getXMLDom(msg);
  var domcnt = getDomLength("item");
  var txt = "";
  for(var i=0; i<domcnt; i++)
  {
    txt = txt + getValue("locNm",i);
  }
  document.getElementById("result").innerHTML=txt;
}
function getXmlOBJ()
{
  var xmlhttp = null;

  // Mozilla/Safari
  if (window.XMLHttpRequest) {
    xmlhttp = new XMLHttpRequest();
  }
  else if (window.ActiveXObject) {// IE
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
  }
  return xmlhttp;
}

function getXMLDom(pUrl,pOption,pSearchValue)
{
  var xmlhttp = getXmlOBJ();
  var templateStr = null;
  var pAsync = false;

  if (pOption == "TRUE")
  {
    pAsync = true;
  }

  if (pOption == "POST")
  {
    xmlhttp.open("POST",pUrl,pAsync);
    xmlhttp.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
  }
  else
  {
    xmlhttp.open("GET",pUrl,pAsync);
  }

  xmlhttp.onreadystatechange = function () {
    if(xmlhttp.readyState == "4")
    {
      xmlDoc = xmlhttp.responseXML;
    }
  }

  xmlhttp.send();
  return xmlDoc;
}

function getDomLength(pName,pDom)
{
  try
  {
    return pDom.getElementsByTagName(pName).length;
  }
  catch (e)
  {
    return xmlDoc.getElementsByTagName(pName).length;
  }
}

function getValue(pName,pIndex,pAttr)
{
  if (typeof pIndex == "undefined" || pIndex =="")
  {
    pIndex = 0;
  }

  x = xmlDoc.getElementsByTagName(pName);

  if (typeof pAttr == "undefined" || pAttr =="")
  {
    if(x[pIndex].hasChildNodes())
    {
      v = x[pIndex].childNodes[0].nodeValue;
    }
    else
    {
      v = "";
    }
  }
  else
  {
    v = x[pIndex].getAttribute(pAttr);
  }
  return v;
}

function getXMLText(pCode,pValue)
{
  var xDom = getXMLDom('code_test.xml');
  var cnt = getDomLength(pCode,xDom);
  var strHTML = ""  ;
  for(var i=0;i<cnt;i++)
  {
    if(getValue(pCode,i,"code") == pValue)
    strHTML = getValue(pCode,i,"text");
  }
  return strHTML;
}

</script>
